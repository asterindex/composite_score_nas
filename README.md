# Stability-Aware Proxy –¥–ª—è –±—é–¥–∂–µ—Ç–Ω–æ–≥–æ Bayesian Optimization

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ—Ç–æ–¥—É Detection Stability Score (DSS) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Å–∏–Ω—Ç–µ–∑—É –∫–æ–º–ø–∞–∫—Ç–Ω–∏—Ö –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂ –¥–µ—Ç–µ–∫—Ü—ñ—ó –æ–±'—î–∫—Ç—ñ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
composite_score_nas/
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ synthesis_universal.py    # –û—Å–Ω–æ–≤–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω —Å–∏–Ω—Ç–µ–∑—É –∑ DSS
‚îú‚îÄ‚îÄ train_top3_models.py     # –ü–æ–≤–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–æ–ø-3 –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä
‚îú‚îÄ‚îÄ data/                    # –î–∞—Ç–∞—Å–µ—Ç VisDrone2019
‚îÇ   ‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îî‚îÄ‚îÄ val/
‚îî‚îÄ‚îÄ results/                 # –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤
    ‚îú‚îÄ‚îÄ optuna_study.pkl
    ‚îú‚îÄ‚îÄ proxy_stats.json
    ‚îî‚îÄ‚îÄ synthesis_results.json
```

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### 2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞—Ç–∞—Å–µ—Ç—É

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ VisDrone2019-DET –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞:
- GitHub: https://github.com/VisDrone/VisDrone-Dataset
- –ü—Ä—è–º–∏–π –ª—ñ–Ω–∫: http://aiskyeye.com/download/object-detection-2/

–†–æ–∑–ø–∞–∫—É–π—Ç–µ —É –ø–∞–ø–∫—É `data/`:
```bash
unzip VisDrone2019-DET-train.zip -d data/train/
unzip VisDrone2019-DET-val.zip -d data/val/
```

### 3. –ó–∞–ø—É—Å–∫ —Å–∏–Ω—Ç–µ–∑—É

```bash
python synthesis_universal.py
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `N_TRIALS = 30` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å trials –¥–ª—è Bayesian Optimization
- `MAX_SAMPLES = 700` - —Ä–æ–∑–º—ñ—Ä —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–æ—ó –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∏
- `EPOCHS_PER_TRIAL = 1` - –µ–ø–æ—Ö–∏ –¥–ª—è low-fidelity evaluation
- `SEED = 42` - –¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —á–∞—Å:**
- –õ–æ–∫–∞–ª—å–Ω–æ (M2 Pro MPS): ~15-18 —Ö–≤–∏–ª–∏–Ω
- Google Colab (T4 GPU): ~10-12 —Ö–≤–∏–ª–∏–Ω
- CPU-only: ~45-50 —Ö–≤–∏–ª–∏–Ω

### 4. –ü–æ–≤–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–æ–ø-3

```bash
python train_top3_models.py
```

## üìä Detection Stability Score (DSS)

DSS - –∫–æ–º–ø–æ–∑–∏—Ç–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä –ø—ñ—Å–ª—è –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è:

```
DSS = w‚ÇÅ¬∑z(impr) + w‚ÇÇ¬∑z(L_val) + w‚ÇÉ¬∑z(loss_cv) + 
      w‚ÇÑ¬∑z(grad_cv) + w‚ÇÖ¬∑z(gap) + w‚ÇÜ¬∑z(L_tr) + w‚Çá¬∑z(grad_norm)
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:**
- `impr` - –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è loss –∑–∞ –µ–ø–æ—Ö—É (–ø—Ä–æ–≥—Ä–µ—Å –Ω–∞–≤—á–∞–Ω–Ω—è)
- `L_val` - validation loss (—è–∫—ñ—Å—Ç—å –Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó)
- `loss_cv` - –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –≤–∞—Ä—ñ–∞—Ü—ñ—ó train loss (—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å)
- `grad_cv` - –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –≤–∞—Ä—ñ–∞—Ü—ñ—ó –Ω–æ—Ä–º–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∞
- `gap` - —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ val —Ç–∞ train loss (—Ä–∞–Ω–Ω—ñ–π –æ–≤–µ—Ä—Ñ—ñ—Ç)
- `L_tr` - —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π train loss
- `grad_norm` - —Å–µ—Ä–µ–¥–Ω—è –Ω–æ—Ä–º–∞ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∞

**z-–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è:** Robust normalization —á–µ—Ä–µ–∑ –º–µ–¥—ñ–∞–Ω—É —Ç–∞ IQR (calibrated –Ω–∞ warmup trials)

## üéØ –ü–æ—à—É–∫–æ–≤–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä

- **–ì–ª–∏–±–∏–Ω–∞:** 2-5 conv-–±–ª–æ–∫—ñ–≤
- **–†–æ–∑–º—ñ—Ä —Ñ—ñ–ª—å—Ç—Ä—ñ–≤:** 16/32/64/128
- **–†–æ–∑–º—ñ—Ä —è–¥–µ—Ä:** 3√ó3 / 5√ó5
- **Dropout:** 0.3/0.5/0.7
- **–ê–∫—Ç–∏–≤–∞—Ü—ñ—ó:** ReLU/LeakyReLU/GELU
- **–û–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä–∏:** Adam/AdamW/SGD
- **Learning rate:** 0.0001/0.001/0.01
- **Weight decay:** 0/1e-5/1e-4/1e-3

**–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä:** ~10‚Åπ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –ù–∞–π–∫—Ä–∞—â–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ (DSS = -1.1032)

```
Architecture: 4 conv-–±–ª–æ–∫–∏
Filters: [Conv(64,5√ó5), Conv(64,5√ó5), Conv(64,5√ó5), Conv(128,3√ó3)]
FC layer: 64
Optimizer: AdamW (LR=0.001, WD=0)
Dropout: 0.5
Activation: LeakyReLU
Batch size: 32
```

### –ö–ª—é—á–æ–≤—ñ –∑–Ω–∞—Ö—ñ–¥–∫–∏

- –û–ø—Ç–∏–º–∞–ª—å–Ω–∞ –≥–ª–∏–±–∏–Ω–∞: **4 –±–ª–æ–∫–∏** (100% —Ç–æ–ø-5)
- –†–æ–∑–º—ñ—Ä —è–¥–µ—Ä: **5√ó5** –¥–ª—è –ø–µ—Ä—à–∏—Ö –±–ª–æ–∫—ñ–≤ (–∫—Ä–∞—â–∞ feature extraction)
- –†–æ–∑–º—ñ—Ä —Ñ—ñ–ª—å—Ç—Ä—ñ–≤: **64** (–ø—Ä–æ—Ç–∏ 16-32 —É baseline)
- Learning rate: **0.001** (—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—à–µ –Ω–∞–≤—á–∞–Ω–Ω—è)

## üî¨ –í—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω—ñ—Å—Ç—å

–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏ –∑ `SEED=42` –¥–∞—é—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω–∞:
- Apple M2 Pro (MPS)
- NVIDIA T4 (CUDA)
- CPU-only

–†—ñ–∑–Ω–∏—Ü—è —É DSS < 0.05 (–æ–±—É–º–æ–≤–ª–µ–Ω–∞ —á–∏—Å–ª–æ–≤–æ—é —Ç–æ—á–Ω—ñ—Å—Ç—é –ø–ª–∞—Ç—Ñ–æ—Ä–º)

## üìù –¶–∏—Ç—É–≤–∞–Ω–Ω—è

```bibtex
@article{kot2026stability,
  title={Stability-Aware Proxy –¥–ª—è –±—é–¥–∂–µ—Ç–Ω–æ–≥–æ Bayesian Optimization —É –¥–µ—Ç–µ–∫—Ü—ñ—ó –æ–±'—î–∫—Ç—ñ–≤},
  author={Kot, Anatoly},
  year={2026}
}
```

## üîó –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- **VisDrone Dataset:** https://github.com/VisDrone/VisDrone-Dataset
- **Optuna:** https://optuna.org/
- **PyTorch:** https://pytorch.org/

---

**–ê–≤—Ç–æ—Ä:** –ê–Ω–∞—Ç–æ–ª—ñ–π –ö–æ—Ç  
**–î–∞—Ç–∞:** 2026-01-24
